<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>First Mapbox Map</title>
    <!-- Mapbox CSS -->
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css' rel='stylesheet'/>
    <!-- Custom CSS -->
    <style>
        #map {
            /* the width and height may be set to any size */
            width: 100%;
            height: 700px;
        }
    </style>
</head>
<body>

<h1>My First Mapbox Map!</h1>

<!-- The HTML element that serves as the Mapbox container -->
<div id='map'></div>

<!-- Mapbox JS -->
<script src='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js'></script>

<!-- Custom JS -->
<script>
    var token = mapboxgl.accessToken = 'pk.eyJ1Ijoid2lsc29uLXN5cmluZyIsImEiOiJjbDluODlnYXkwNDFjM3pwOGZ3Mnk1NzF3In0.wmPIQOmiE5eEw5TLJ5nlEQ';

    function geocode(search, token) {
    var baseUrl = 'https://api.mapbox.com';
    var endPoint = '/geocoding/v5/mapbox.places/';
    return fetch(baseUrl + endPoint + encodeURIComponent(search) + '.json' + "?" + 'access_token=' + token)
        .then(function(res) {
            return res.json();
            // to get all the data from the request, comment out the following three lines...
        }).then(function(data) {
            return data.features[0].center;
        });
}
    function reverseGeocode(coordinates, token) {
        var baseUrl = 'https://api.mapbox.com';
        var endPoint = '/geocoding/v5/mapbox.places/';
        return fetch(baseUrl + endPoint + coordinates.lng + "," + coordinates.lat + '.json' + "?" + 'access_token=' + token)
            .then(function(res) {
                return res.json();
            })
            // to get all the data from the request, comment out the following three lines...
            .then(function(data) {
                return data.features[0].place_name;
            });
    }

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 14,
        center: [-98.64666, 29.51036]
    });
    // let marker = new mapboxgl.Marker()
    //     .setLngLat([-98.64666, 29.51036])
    //     .setPopup(new mapboxgl.Popup().setHTML("<p>Kens House!</p>"))
    //     .addTo(map)

   geocode("4326 hoeneke dr", token).then(function(result){
       console.log(result)
       let marker2 = new mapboxgl.Marker()
           .setLngLat(result)
           .setPopup(new mapboxgl.Popup().setHTML("<p>Wilson's House!</p>"))
           .addTo(map)
   });
    reverseGeocode({lng: -98.64666, lat: 29.51036}, token).then(function(result){
        alert(result)
    });
</script>
</body>
</html>